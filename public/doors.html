<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Doors</title>
    <link rel="stylesheet" href="doors.css">
    <!-- Manifest for install prompt & app info -->
    <link rel="manifest" href="/manifest.json" />
    <meta name="theme-color" content="#121212">

    <!-- Favicon -->
    <link rel="icon" href="/icons/icon-192x192.png">
    <!-- For iOS support -->
    <link rel="apple-touch-icon" href="/icons/icon-192x192.png">

</head>
<body>
    <div class="header">
        <div class="logo-container">
            <svg class="door-icon" xmlns="http://www.w3.org/2000/svg" viewBox="3 6 24 24">
                <path d="M18 2H6c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zm0 18H6V4h12v16z"/>
                <circle cx="15" cy="12" r="1.5"/>
            </svg>
            <h1>Doors</h1>
        </div>
        <p class="tagline">Close it and never find it again !!</p>
        <a href="about.html">New to Doors ? , Click here to know more.</a>
        <br><br>
        <button id="createRoom">Create New Room</button>
    </div>
    
    <div id="active_rooms" class="room-container">
        <div class="empty-state">No active rooms. Create one to get started!</div>
    </div>
    
    <script src="https://dechat-o5h4.onrender.com/socket.io/socket.io.js"></script>
    <script src="doors.js"></script>
    <script>
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('/service-worker.js')
                .then(registration => {
                    // Check for updates
                    registration.onupdatefound = () => {
                    const newWorker = registration.installing;
                    newWorker.onstatechange = () => {
                        if (newWorker.state === 'installed') {
                            if (navigator.serviceWorker.controller) {
                                // New update available
                                showUpdateNotification(newWorker);
                            }
                        }
                    };
                };
            });
        });
        }

        function showUpdateNotification(worker) {
            const updateBanner = document.createElement('div');
            updateBanner.style = `
                position: fixed;
                bottom: 0;
                width: 100%;
                background: #222;
                color: white;
                text-align: center;
                padding: 10px;
                z-index: 9999;
            `;
            updateBanner.innerHTML = `
                Kindly Update for better experience ðŸ¥‚<button id="reload">Refresh</button>
            `;

            document.body.appendChild(updateBanner);

            document.getElementById('reload').addEventListener('click', () => {
                worker.postMessage({ action: 'skipWaiting' });
            });
        }


    </script>
</body>
</html>